# 🚨 URGENT: Update Render Environment Variables

## 🔍 Problem

- ✅ **Local (localhost):** OTP emails working perfectly
- ❌ **Production (Vercel):** OTP emails NOT working

**Why?** Your Vercel frontend uses the Render backend, which still has OLD email credentials!

---

## ✅ Solution: Update Render Dashboard NOW

### Step 1: Go to Render Dashboard

**Open this link:** https://dashboard.render.com

### Step 2: Select Your Backend Service

1. Click on **`quicksnack-backend`** (or your backend service name)
2. You should see the service overview

### Step 3: Go to Environment Tab

1. Click on **"Environment"** in the left sidebar
2. You'll see a list of environment variables

### Step 4: Update These Variables

**Find and update each of these:**

#### 1. EMAIL_USER
- **Current value:** Might be `officialvyom@gmail.com` or old value
- **New value:** `vyomverma2873@gmail.com`
- Click "Edit" → Change → Click "Save"

#### 2. EMAIL_PASS
- **Current value:** Old or incorrect password
- **New value:** `qwlkaatwfvwfipxq`
- Click "Edit" → Change → Click "Save"

#### 3. SMTP_HOST
- **Should be:** `smtp.gmail.com`
- If not present, click "Add Environment Variable"

#### 4. SMTP_PORT
- **Should be:** `587`
- If not present, click "Add Environment Variable"

### Step 5: Remove Old Variables

**Delete these if they exist:**
- ❌ `RESEND_API_KEY` - Not needed anymore
- ❌ Any old email-related variables

### Step 6: Save Changes

1. After updating all variables, click **"Save Changes"** at the bottom
2. Render will automatically **redeploy** your backend
3. Wait for the deployment to complete (2-5 minutes)

---

## ⏱️ Wait for Deployment

### Monitor the Deployment:

1. Stay on the Render dashboard
2. You'll see **"Deploying..."** status
3. Wait until it shows **"Live"** with a green dot

### Check the Logs:

1. Click on **"Logs"** tab
2. Look for these success messages:
   ```
   ✅ Email server is ready to send messages
   ✅ Connected to MongoDB Atlas
   ✅ QuickSnack server running on 0.0.0.0:10000
   ```

3. If you see errors, check the environment variables again

---

## 🧪 Test Production After Update

### Step 1: Wait for "Live" Status

Make sure Render shows:
- ✅ Green "Live" indicator
- ✅ No errors in logs
- ✅ "Email server is ready" message in logs

### Step 2: Test Your Vercel App

1. Go to your Vercel deployment URL
2. Try to **login or signup** with any email
3. **Check your email inbox AND spam folder**
4. You should receive the OTP!

### Step 3: Test Different Emails

Try with:
- ✅ Gmail addresses
- ✅ Yahoo addresses
- ✅ Any other email providers
- ✅ All should work now!

---

## 📋 Quick Checklist

### Before Testing:
- [ ] Opened Render Dashboard
- [ ] Selected `quicksnack-backend` service
- [ ] Went to Environment tab
- [ ] Updated `EMAIL_USER` to `vyomverma2873@gmail.com`
- [ ] Updated `EMAIL_PASS` to `qwlkaatwfvwfipxq`
- [ ] Verified `SMTP_HOST` is `smtp.gmail.com`
- [ ] Verified `SMTP_PORT` is `587`
- [ ] Removed `RESEND_API_KEY` (if present)
- [ ] Clicked "Save Changes"
- [ ] Waited for deployment to complete
- [ ] Status shows "Live"
- [ ] Logs show "Email server is ready"

### After Update:
- [ ] Tested login on Vercel app
- [ ] Received OTP email
- [ ] Checked spam folder
- [ ] OTP verification works
- [ ] Welcome email received (after signup)

---

## 🔍 Troubleshooting

### If Deployment Fails:

**Check Logs for Errors:**
```
❌ EMAIL_PASS is not defined
❌ Authentication failed
❌ Invalid login
```

**Solution:**
- Double-check all environment variables
- Make sure no typos in EMAIL_PASS
- Verify EMAIL_USER is exactly: `vyomverma2873@gmail.com`

### If Still No Emails:

1. **Check Render Logs:**
   - Look for "Email sent successfully" messages
   - Or "Email sending failed" errors

2. **Check Gmail Account:**
   - Go to: https://mail.google.com
   - Sign in with: vyomverma2873@gmail.com
   - Check "Sent" folder to see if emails are being sent

3. **Check Spam Folder:**
   - Gmail often puts automated emails in spam
   - Check the spam folder of the email you're testing with

---

## 📊 Environment Variables Reference

### Copy-Paste Ready Values:

```env
EMAIL_USER=vyomverma2873@gmail.com
EMAIL_PASS=qwlkaatwfvwfipxq
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
```

### Other Required Variables (Should Already Be Set):

```env
NODE_ENV=production
MONGO_URI=mongodb+srv://QuickSnack:QuickSnack%4037@quicksnack.wmea4h4.mongodb.net/?retryWrites=true&w=majority&appName=QuickSnack
JWT_SECRET=<auto-generated-by-render>
JWT_EXPIRES_IN=7d
FRONTEND_URL=<your-vercel-url>
```

---

## 🎯 Expected Behavior After Fix

### What Should Happen:

1. **User visits Vercel app**
2. **User clicks "Login" or "Signup"**
3. **User enters email**
4. **Backend sends OTP email** (Render logs show success)
5. **User receives email within 10-30 seconds**
6. **User enters OTP and verifies**
7. **User is logged in successfully**

### Email Details:

- **From:** vyomverma2873@gmail.com
- **Subject:** "Your QuickSnack OTP"
- **Content:** 6-digit OTP code
- **Valid for:** 10 minutes

---

## 🆘 Need Help?

### If you're stuck:

1. **Take a screenshot** of the Render environment variables page
2. **Check Render logs** for specific error messages
3. **Test locally first** to confirm it's a Render issue
4. **Verify Gmail account** settings (2FA enabled, IMAP enabled)

### Contact Info:

- **Email:** vyomverma2873@gmail.com
- **Phone:** +91 8766355495

---

## ✅ Success Indicators

### You'll know it's working when:

- ✅ Render shows "Live" status
- ✅ Logs show "Email server is ready"
- ✅ No errors in Render logs
- ✅ Test signup on Vercel app works
- ✅ OTP email received in inbox or spam
- ✅ OTP verification succeeds
- ✅ Welcome email received after signup

---

## 🚀 Final Steps

1. **Update Render environment variables** (do this NOW!)
2. **Wait for deployment** (2-5 minutes)
3. **Test on Vercel app**
4. **Check email (including spam)**
5. **Celebrate!** 🎉

---

**⚠️ IMPORTANT: You MUST update the Render Dashboard manually. The render.yaml file is just a template - it doesn't automatically update existing deployments!**

**Go to Render Dashboard NOW and update the environment variables!** 🚀
